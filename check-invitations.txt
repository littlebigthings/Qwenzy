  // Check if user has any active invitations in the database
  useEffect(() => {
    const checkUserInvitations = async () => {
      if (!user || isInvitation) return; // Skip if we already have invitation from URL or if no user
      
      try {
        // Query invitations table for the user's email
        const { data: invitations, error } = await supabase
          .from('invitations')
          .select('organization_id')
          .eq('email', user.email)
          .eq('accepted', false)
          .limit(1);
          
        if (error) {
          console.error("Error checking user invitations:", error);
          return;
        }
        
        // If there's an invitation, set the state
        if (invitations && invitations.length > 0) {
          console.log("Found invitation in database:", invitations[0].organization_id);
          setIsInvitation(true);
          setInvitationOrgId(invitations[0].organization_id);
        }
      } catch (error) {
        console.error("Error in invitation check:", error);
      }
    };
    
    checkUserInvitations();
  }, [user, isInvitation]);
